(function(){var t,n,e=[].slice,i=[].indexOf||function(t){for(var n=0,e=this.length;n<e;n++)if(n in this&&this[n]===t)return n;return-1};n=function(){function t(t){this.elem=t}return t.prototype.test=function(){return setTimeout(function(t){return function(){return t.add("connection","error","Connection lost to <b>UiServer</b> on <b>localhost</b>!"),t.add("message-Anyone","info","New  from <b>Anyone</b>.")}}(this),1e3),setTimeout(function(t){return function(){return t.add("connection","done","<b>UiServer</b> connection recovered.",5e3)}}(this),3e3)},t.prototype.add=function(t,n,e,i){var o,s,r,a,c;for(null==i&&(i=0),t=t.replace(/[^A-Za-z0-9]/g,""),a=$(".notification-"+t),s=0,r=a.length;s<r;s++)o=a[s],this.close($(o));return o=$(".notification.notificationTemplate",this.elem).clone().removeClass("notificationTemplate"),o.addClass("notification-"+n).addClass("notification-"+t),"progress"===n&&o.addClass("notification-done"),"error"===n?$(".notification-icon",o).html("!"):"done"===n?$(".notification-icon",o).html("<div class='icon-success'></div>"):"progress"===n?$(".notification-icon",o).html("<div class='icon-success'></div>"):"ask"===n?$(".notification-icon",o).html("?"):$(".notification-icon",o).html("i"),"string"==typeof e?$(".body",o).html("<span class='message'>"+e+"</span>"):$(".body",o).html("").append(e),o.appendTo(this.elem),i&&($(".close",o).remove(),setTimeout(function(t){return function(){return t.close(o)}}(this),i)),c=o.outerWidth(),i||(c+=20),o.outerHeight()>55&&o.addClass("long"),o.css({width:"50px",transform:"scale(0.01)"}),o.animate({scale:1},800,"easeOutElastic"),o.animate({width:c},700,"easeInOutCubic"),$(".body",o).cssLater("box-shadow","0px 0px 5px rgba(0,0,0,0.1)",1e3),$(".close, .button",o).on("click",function(t){return function(){return t.close(o),!1}}(this)),$(".select",o).on("click",function(t){return function(){return t.close(o)}}(this)),o},t.prototype.close=function(t){return t.stop().animate({width:0,opacity:0},700,"easeInOutCubic"),t.slideUp(300,function(){return t.remove()})},t.prototype.log=function(){var t;return t=1<=arguments.length?e.call(arguments,0):[],console.log.apply(console,["[Notifications]"].concat(e.call(t)))},t.prototype.displayOpenerDialog=function(){var t;return t=$("<div class='opener-overlay'><div class='dialog'>You have opened this page by clicking on a link. Please, confirm if you want to load this site.<a href='?' target='_blank' class='button'>Open site</a></div></div>"),t.find("a").on("click",function(){return window.open("?","_blank"),window.close(),!1}),$("body").prepend(t)},t.prototype.actionOpenWindow=function(t){var n;return"string"==typeof t?(n=window.open(),n.opener=null,n.location=t):(n=window.open(null,t[1],t[2]),n.opener=null,n.location=t[0])},t.prototype.actionRequestFullscreen=function(){var t,n;return i.call(this.site_info.settings.permissions,"Fullscreen")>=0?(t=document.getElementById("inner-iframe"),n=t.requestFullScreen||t.webkitRequestFullscreen||t.mozRequestFullScreen||t.msRequestFullScreen,n.call(t),setTimeout(function(e){return function(){if(window.innerHeight!==screen.height)return e.displayConfirm("This site requests permission: <b>Fullscreen</b>","Grant",function(){return n.call(t)})}}(this),100)):this.displayConfirm("This site requests permission: <b>Fullscreen</b>","Grant",function(t){return function(){return t.site_info.settings.permissions.push("Fullscreen"),t.actionRequestFullscreen(),t.ws.cmd("permissionAdd","Fullscreen")}}(this))},t.prototype.actionPermissionAdd=function(t){var n;return n=t.params,this.displayConfirm("This site requests permission:"+(" <b>"+this.toHtmlSafe(n)+"</b>"),"Grant",function(e){return function(){return e.ws.cmd("permissionAdd",n,function(){return e.sendInner({cmd:"response",to:t.id,result:"Granted"})})}}(this))},t.prototype.actionNotification=function(t){var n;return t.params=this.toHtmlSafe(t.params),n=$("<span class='message'>"+t.params[1]+"</span>"),this.add("notification-"+t.id,t.params[0],n,t.params[2])},t.prototype.displayConfirm=function(t,n,e,i){var o,s,r;return null==e&&(e=!1),o=$("<span class='message'>"+t+"</span>"),s=$("<a href='#"+n+"' class='button button-"+n+"'>"+n+"</a>"),s.on("click",function(t){return function(){return i(!0),!1}}(this)),o.append(s),e&&(r=$("<a href='#"+e+"' class='button button-"+e+"'>"+e+"</a>"),r.on("click",function(t){return function(){return i(!1),!1}}(this)),o.append(r)),this.add("notification-"+n,"ask",o),s.focus(),$(".notification").scrollLeft(0)},t.prototype.actionConfirm=function(t,n){var e;return null==n&&(n=!1),t.params=this.toHtmlSafe(t.params),e=t.params[1]?t.params[1]:"ok",this.displayConfirm(t.params[0],e,function(n){return function(){return n.sendInner({cmd:"response",to:t.id,result:"boom"}),!1}}(this))},t.prototype.displayPrompt=function(t,n,e,i){var o,s,r;return o=$("<span class='message'>"+t+"</span>"),r=$("<input type='"+n+"' class='input button-"+n+"'/>"),r.on("keyup",function(t){return function(t){if(13===t.keyCode)return s.trigger("click")}}(this)),o.append(r),s=$("<a href='#"+e+"' class='button button-"+e+"'>"+e+"</a>"),s.on("click",function(t){return function(){return i(r.val()),!1}}(this)),o.append(s),this.add("notification-"+t.id,"ask",o),r.focus(),$(".notification").scrollLeft(0)},t.prototype.actionPrompt=function(t){var n,e;return t.params=this.toHtmlSafe(t.params),e=t.params[1]?t.params[1]:"text",n="OK",this.displayPrompt(t.params[0],e,n,function(n){return function(e){return n.sendInner({cmd:"response",to:t.id,result:e})}}(this))},t.prototype.actionProgress=function(t){var n,e,i,o,s,r;return s=Math.min(100,t.percent)/100,o=75-75*s,e='<div class="circle"><svg class="circle-svg" width="30" height="30" viewport="0 0 30 30" version="1.1" xmlns="http://www.w3.org/2000/svg">\n  \t\t\t\t<circle r="12" cx="15" cy="15" fill="transparent" class="circle-bg"></circle>\n  \t\t\t\t<circle r="12" cx="15" cy="15" fill="transparent" class="circle-fg" style="stroke-dashoffset: '+o+'"></circle>\n</svg></div>',n="<span class='message'>"+t.content+"</span>"+e,i=$(".notification-"+t.id),i.length?(r=$(".body .message",i).outerWidth(),$(".body .message",i).html(t.content),""===$(".body .message",i).css("width")&&$(".body .message",i).css("width",r),$(".body .circle-fg",i).css("stroke-dashoffset",o)):i=this.add(t.id,"progress",$(n)),s>0&&$(".body .circle-bg",i).css({"animation-play-state":"paused","stroke-dasharray":"180px"}),!$(".notification-icon",i).data("done")&&(t.percent>=100?($(".circle-fg",i).css("transition","all 0.3s ease-in-out"),setTimeout(function(){return $(".notification-icon",i).css({transform:"scale(1)",opacity:1}),$(".notification-icon .icon-success",i).css({transform:"rotate(45deg) scale(1)"})},300),t.autoClose&&setTimeout(function(t){return function(){return t.close(i)}}(this),3e3),$(".notification-icon",i).data("done",!0)):t.percent<0?($(".body .circle-fg",i).css("stroke","#ec6f47").css("transition","transition: all 0.3s ease-in-out"),setTimeout(function(t){return function(){return $(".notification-icon",i).css({transform:"scale(1)",opacity:1}),i.removeClass("notification-done").addClass("notification-error"),$(".notification-icon .icon-success",i).removeClass("icon-success").html("!")}}(this),300),$(".notification-icon",i).data("done",!0)):void 0)},t.prototype.toHtmlSafe=function(t){var n,e,i,o;for(t instanceof Array||(t=[t]),n=e=0,i=t.length;e<i;n=++e)o=t[n],o=String(o).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),o=o.replace(/&lt;([\/]{0,1}(br|b|u|i))&gt;/g,"<$1>"),t[n]=o;return t},t}(),t=function(){function t(t,n){var e,i,o,s,r;for(this.main=t,this.main_elem=this.main.elem,this.id=n.id.replace(/[^A-Za-z0-9]/g,""),s=$(".notification-"+this.id),i=0,o=s.length;i<o;i++)e=s[i],this.close($(e));this.elem=$(".notification.notificationTemplate",this.main_elem).clone().removeClass("notificationTemplate"),this.elem.addClass("notification-"+type).addClass("notification-"+id),"progress"===type&&this.elem.addClass("notification-done"),updateText(type),"string"==typeof body?$(".body",e).html("<span class='message'>"+escape(n.body)+"</span>"):$(".body",e).html("").append(body),e.appendTo(this.elem),timeout&&($(".close",e).remove(),setTimeout(function(t){return function(){return t.close(e)}}(this),timeout)),r=e.outerWidth(),timeout||(r+=20),e.outerHeight()>55&&e.addClass("long"),e.css({width:"50px",transform:"scale(0.01)"}),e.animate({scale:1},800,"easeOutElastic"),e.animate({width:r},700,"easeInOutCubic"),$(".body",e).cssLater("box-shadow","0px 0px 5px rgba(0,0,0,0.1)",1e3),$(".close, .button",e).on("click",function(t){return function(){return t.close(e),!1}}(this)),$(".select",e).on("click",function(t){return function(){return t.close(e)}}(this)),this.elem=e}return t}(),window.Notifications=n}).call(this),function(){var t;jQuery.cssHooks.scale={get:function(n,e){var i,o;return i=window.getComputedStyle(n)[t].match("[0-9.]+"),i?o=parseFloat(i[0]):1},set:function(n,e){var i;return i=window.getComputedStyle(n)[t].match(/[0-9\.]+/g),i?(i[0]=e,i[3]=e,n.style[t]="matrix("+i.join(", ")+")"):n.style[t]="scale("+e+")"}},jQuery.fx.step.scale=function(t){return jQuery.cssHooks.scale.set(t.elem,t.now)},t=window.getComputedStyle(document.body).transform?"transform":"webkitTransform"}.call(this),function(){jQuery.fn.readdClass=function(t){var n;return n=this,n.removeClass(t),setTimeout(function(){return n.addClass(t)},1),this},jQuery.fn.removeLater=function(t){var n;return null==t&&(t=500),n=this,setTimeout(function(){return n.remove()},t),this},jQuery.fn.hideLater=function(t){var n;return null==t&&(t=500),n=this,setTimeout(function(){if(0===n.css("opacity"))return n.css("display","none")},t),this},jQuery.fn.addClassLater=function(t,n){var e;return null==n&&(n=5),e=this,setTimeout(function(){return e.addClass(t)},n),this},jQuery.fn.cssLater=function(t,n,e){var i;return null==e&&(e=500),i=this,setTimeout(function(){return i.css(t,n)},e),this}}.call(this);